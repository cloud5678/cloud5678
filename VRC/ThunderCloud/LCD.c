#pragma config(UART_Usage, UART2, uartVEXLCD, baudRate19200, IOPins, None, None)

//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

const short lcd_kLeftBtn = 1;
const short lcd_kCenterBtn = 2;
const short lcd_kRightBtn = 4;
const short lcd_autonModeNOTH = 0;
const short lcd_autonModeMID = 1;
const short lcd_autonModeHANG = 2;
const short lcd_autonModeMID2 = 3;
const short lcd_autonModeBLUE = true;
const short lcd_autonModeRED = false;
int lcd_autonMode = lcd_autonModeMID;
bool lcd_autonColor = lcd_autonModeRED;


void clearLCD(){
	clearLCDLine(0);
	clearLCDLine(1);
}

void batteryInfo() {
	string mainBattery, backupBattery;//, peBattery;
	//Display main battery voltage
	sprintf(mainBattery, "%1.2f%c", nImmediateBatteryLevel/1000.0,'V'); // Build the value to be displayed
	string line1="M: ";
	strcat(line1,mainBattery);

	//Display Power Expander battery voltage
	/*int peBatteryLevel=SensorValue[powerexp];
	sprintf(peBattery, "%1.1f%c", peBatteryLevel/182.4,'V'); //Build the value to be displayed
	string line1Part2 = " E: ";
	strcat(line1Part2, peBattery);
	strcat(line1,line1Part2);
	displayLCDString(0,0,line1);*/

	//Display the Backup battery voltage
	sprintf(backupBattery, "%1.2f%c", BackupBatteryLevel/1000.0, 'V');    // Build the value to be displayed
	string line1p2=" B: ";
	strcat(line1, line1p2);
	strcat(line1,backupBattery);
	displayLCDString(0,0,line1);
}
int prevPress = 0;
void autonSelect() {
	if (nLCDButtons == prevPress) {
		return;
	}
	prevPress = nLCDButtons;
	string line2="A: ";
	if (nLCDButtons == lcd_kLeftBtn) {
			lcd_autonMode++;
			if (lcd_autonMode > 3) {
				lcd_autonMode = 0;
			}
	}
	if (nLCDButtons == lcd_kCenterBtn) {
			lcd_autonColor = !lcd_autonColor;
	}

	string mode = "MERR ", color = "CERR";
	switch (lcd_autonMode) {
		case lcd_autonModeNOTH:
			mode = "NIL  ";
			break;
		case lcd_autonModeMID:
			mode = "MID  ";
			break;
		case lcd_autonModeHANG:
			mode = "HANG ";
			break;
		case lcd_autonModeMID2:
			mode = "MID2 ";
			break;
	}
	color = lcd_autonColor == lcd_autonModeBLUE ? "BLUE" : "RED ";


	strcat(line2, mode);
	strcat(line2, color);
	displayLCDString(1,0,line2);
}

task LCDController() {
	while (true) {
		batteryInfo();
		autonSelect();
		wait1Msec(100);
	}
}
